<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Linear regression and her bigger brother BART: Treatment effects in the labor market</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Start</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Covid_19_Germany.html">Mortality 20/21: Germany</a>
</li>
<li>
  <a href="Scale.html">Scale</a>
</li>
<li>
  <a href="Trends.html">Trends</a>
</li>
<li>
  <a href="Histories.html">Histories</a>
</li>
<li>
  <a href="BartLabor.html">What if..?</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="feed.xml">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
<li>
  <a href="https://de.linkedin.com/in/florian-klohn-a3a87562">
    <span class="fa fa-linkedin"></span>
     
  </a>
</li>
<li>
  <a href="mailto:&lt;boiled.data@gmail.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Linear regression and her bigger brother BART: Treatment effects in the labor market</h1>
<h4 class="date">1 Oct 2022</h4>

</div>


<pre class="r"><code>#Preliminaries:
knitr::opts_chunk$set(message=FALSE, warning=FALSE, eval = TRUE) #set eval = TRUE when run first

rm(list=ls())

library(tidyverse)
library(haven)
library(bartCause)
library(kableExtra)
library(tableone)
library(gridExtra)
library(grid)

theme_set(theme_light())</code></pre>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Evaluation of the effectiveness of labor market programs is of great importance in order to learn how to design good programs and provide support efficiently. Consequently, there is a huge literature on the evaluation of labor market trainings and we add to this by allowing for heterogeneous treatment effects. We will evaluate the effectiveness of a federally-funded labor treatment program <span class="citation">(LaLonde, 1986)</span> which was implemented in the mid-1970s (US) with the objective of providing work experience. The male subsample we use consists of experimental treatment units and non-experimental comparison units <span class="citation">(Dehejia &amp; Wahba, 1999)</span>. Let us assess whether the treatment had an impact on earnings given available pre-treatment variables.</p>
</div>
<div id="the-data" class="section level2">
<h2>The Data</h2>
<pre class="r"><code>#download the data:
#lalonde &lt;- haven::read_dta(&quot;http://www.nber.org/~rdehejia/data/nsw.dta&quot;) 
#saveRDS(lalonde, file=&quot;lalonde1986.rds&quot;)
lalonde_in &lt;- readRDS(&quot;lalonde1986.rds&quot;) 

lalonde &lt;- lalonde_in %&gt;%
            mutate(race=as_factor(case_when(black==1 ~ &#39;black&#39;,
                                  hispanic==1 ~ &#39;hispanic&#39;,
                                  TRUE ~ &#39;other&#39;))) %&gt;%
           select(-c(black, hispanic, data_id)) %&gt;%
           relocate(re78, .before = 1)


allvars &lt;- colnames(lalonde)
allvars &lt;- allvars[allvars!=&#39;treat&#39;] 
catvars &lt;- c(&quot;race&quot;, &quot;married&quot;, &quot;nodegree&quot;)


#Descriptive Statistics:
tab1 &lt;- CreateTableOne(vars = allvars, strata=&quot;treat&quot;, data = lalonde, factorVars = catvars) 

kableone(tab1, caption = &quot;Table 1: Descriptive Statistics&quot;, col.names=c(&quot;Treat=0&quot;, &quot;Treat=1&quot;, &quot;p&quot;, &quot;&quot;))  %&gt;%
  remove_column(5) %&gt;%
  kable_classic(full_width = F)</code></pre>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Table 1: Descriptive Statistics
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Treat=0
</th>
<th style="text-align:left;">
Treat=1
</th>
<th style="text-align:left;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
425
</td>
<td style="text-align:left;">
297
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
re78 (mean (SD))
</td>
<td style="text-align:left;">
5090.05 (5718.09)
</td>
<td style="text-align:left;">
5976.35 (6923.80)
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
age (mean (SD))
</td>
<td style="text-align:left;">
24.45 (6.59)
</td>
<td style="text-align:left;">
24.63 (6.69)
</td>
<td style="text-align:left;">
0.721
</td>
</tr>
<tr>
<td style="text-align:left;">
education (mean (SD))
</td>
<td style="text-align:left;">
10.19 (1.62)
</td>
<td style="text-align:left;">
10.38 (1.82)
</td>
<td style="text-align:left;">
0.136
</td>
</tr>
<tr>
<td style="text-align:left;">
married = 1 (%)
</td>
<td style="text-align:left;">
67 (15.8)
</td>
<td style="text-align:left;">
50 (16.8)
</td>
<td style="text-align:left;">
0.778
</td>
</tr>
<tr>
<td style="text-align:left;">
nodegree = 1 (%)
</td>
<td style="text-align:left;">
346 (81.4)
</td>
<td style="text-align:left;">
217 (73.1)
</td>
<td style="text-align:left;">
0.010
</td>
</tr>
<tr>
<td style="text-align:left;">
re75 (mean (SD))
</td>
<td style="text-align:left;">
3026.68 (5201.25)
</td>
<td style="text-align:left;">
3066.10 (4874.89)
</td>
<td style="text-align:left;">
0.918
</td>
</tr>
<tr>
<td style="text-align:left;">
race (%)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.567
</td>
</tr>
<tr>
<td style="text-align:left;">
black
</td>
<td style="text-align:left;">
340 (80.0)
</td>
<td style="text-align:left;">
238 (80.1)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
hispanic
</td>
<td style="text-align:left;">
48 (11.3)
</td>
<td style="text-align:left;">
28 ( 9.4)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
37 ( 8.7)
</td>
<td style="text-align:left;">
31 (10.4)
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>Table 1 shows that the mean of our variable of interest, the outcome <em>re78</em> (income in 1978) is higher in our treatment group. Despite the observational character of our data, we see that the sample is relatively homogeneous concerning the pre-treatment variables: only the indicator variable <em>nodegree</em>, on whether a person has a high school diploma, seems to vary between treatment and control group significantly.</p>
</div>
<div id="strategy-empirical-analysis" class="section level2">
<h2>Strategy &amp; Empirical Analysis</h2>
<p>In the potential outcome framework <span class="citation">(Rubin, 2005)</span> the average treatment effect (ATE) can be written as the expectation <span class="math inline">\(E(\delta)=E[y^1-y^0]\)</span>, where <span class="math inline">\(y^1\)</span> and <span class="math inline">\(y^0\)</span> are potential outcomes of income in 1978. Under conditional independence assumption <span class="math inline">\((y^1,y^0)\bot T|X\)</span> these outcomes are independent of treatment <span class="math inline">\(T\)</span> given covariates <span class="math inline">\(X\)</span>.</p>
<p>We use 2 methods in order to estimate the average treatment effect (ATE). Firstly, we apply the well known linear regression for estimation and risk adjustment <span class="citation">(eg. Angrist &amp; Pischke, 2009; Pearl, 2013)</span>. Secondly, we consider Bayesian Additive Regression Trees <span class="citation">(Chipman et al., 2010; J. L. Hill, 2011)</span>, a machine learning model recently becoming popular as it allows to detect relevant interactions in the data generating process and can be used to estimate heterogeneous treatment effects as well <span class="citation">(Carnegie et al., 2019; J. Hill et al., 2020)</span>.</p>
<pre class="r"><code>#Linear regression

lm &lt;- lm(re78 ~ treat + re75 + age + education + race + married + nodegree, data=lalonde)

ate_lm &lt;- as.data.frame(coef(lm)) %&gt;%
        bind_cols(confint(lm)) %&gt;%
        rownames_to_column() %&gt;%
        filter(rowname==&#39;treat&#39;) %&gt;%
        rename(estimate=`coef(lm)`, ci.lower=`2.5 %`, ci.upper=`97.5 %`) %&gt;%
        mutate(model=&#39;LinReg&#39;) %&gt;%
        relocate(model, .before=1) %&gt;%
        select(-rowname)
  
#BART

bc_fit &lt;- bartc(lalonde[,&#39;re78&#39;], lalonde[,&#39;treat&#39;], lalonde[,3:8], n.samples = 1000L, estimand=&#39;ate&#39;,
                method.rsp=&#39;bart&#39;, method.trt=&#39;glm&#39;, verbose = FALSE) 


ate_bart &lt;- summary(bc_fit)$estimates %&gt;%
            select(-sd) %&gt;%
            mutate(model=&#39;BART&#39;)  %&gt;%
            relocate(model, .before=1)

#Prepare ATE-Output
ate &lt;- ate_lm %&gt;%
      bind_rows(ate_bart)

rownames(ate) &lt;- NULL

kable(
  ate,
  digits = 2,
  caption = &quot;Table 2: Treatment effect on income&quot;
) %&gt;%
  kable_classic(full_width = F) %&gt;% 
  footnote(general = &quot;ci: 95 % confidence intervals for linear regression, \n credible intervals for BART &quot;)</code></pre>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
Table 2: Treatment effect on income
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
ci.lower
</th>
<th style="text-align:right;">
ci.upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
LinReg
</td>
<td style="text-align:right;">
806.51
</td>
<td style="text-align:right;">
-112.09
</td>
<td style="text-align:right;">
1725.11
</td>
</tr>
<tr>
<td style="text-align:left;">
BART
</td>
<td style="text-align:right;">
803.05
</td>
<td style="text-align:right;">
-308.61
</td>
<td style="text-align:right;">
1914.71
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> ci: 95 % confidence intervals for linear regression, <br> credible intervals for BART
</td>
</tr>
</tfoot>
</table>
<p>We recognize in Table 2 that the treatment effect of BART is very similar to linear regression. The ATE-point estimates are both positive, suggesting that program participation increases average income by about 800 USD. However, both 95% confidence-, credible intervals show that there is a lot of variability in the data – an effect of zero cannot be rejected.</p>
<p>In addition to one point estimate we often would like to have information on treatment effects for specific subgroups. This could help us to redesign the program or allow for more effective enrollment. Obviously, these questions can be of interest also in other areas – imagine online marketing or personalized medicine for example. Thankfully, BART can also provide treatment effects for each observation in the data, which are called the individual conditional average treatment effects (iCATE): <span class="math inline">\(\tau(X_i)=E[y^1_i-y^0_i|X_i]\)</span>. Let us have a look at the distribution of individual CATE in Figure 1.</p>
<pre class="r"><code>#Extract individual treatment effects
i_cate &lt;- fitted(bc_fit, type=&quot;icate&quot;, sample = c(&quot;all&quot;))


data_cate &lt;- lalonde %&gt;%
  bind_cols(as.data.frame(i_cate))
  

#Histogram CATE
data_cate %&gt;%
  ggplot(aes(x=i_cate)) +
  geom_histogram(bins=20, color=&#39;black&#39;, fill=&#39;grey&#39;) + 
  theme_minimal() + labs(y = &#39;Number of people&#39;, x=&#39;individual CATE&#39;, title=&#39;Figure 1: Distribution of iCATE&#39;)</code></pre>
<p><img src="BartLabor_files/figure-html/chk3-1.png" width="672" /></p>
<p>Interestingly, although the peak of the distribution is around 800 similar to ATE from above, the treatment effects vary a lot. There are even individuals for which a negative effect can be seen. In order to better understand the data generating process, we want to check next whether the individual treatment effects vary with explanatory variables, that could moderate the treatment effect. Figure 2 visualizes the treatment effects dependent on numeric variables age, income and years of education before treatment.</p>
<pre class="r"><code>#Scatterplots:

#age
p2 &lt;- data_cate %&gt;%
  mutate(treat=as_factor(treat)) %&gt;%
  ggplot(aes(y=i_cate, x=age)) +
  geom_point(aes(color=treat)) +
  scale_colour_manual(values=c(&quot;blue&quot;, &quot;orange&quot;)) +
  geom_smooth(color=&#39;black&#39;) +
  theme_minimal() 


#income
p3 &lt;- data_cate %&gt;%
   mutate(treat=as_factor(treat)) %&gt;%
  ggplot(aes(y=i_cate, x=re75)) +
  geom_point(aes(color=treat)) +
  scale_colour_manual(values=c(&quot;blue&quot;, &quot;orange&quot;)) +
  geom_smooth(color=&#39;black&#39;) +
  theme_minimal() 


#educ
p4 &lt;- data_cate %&gt;%
   mutate(treat=as_factor(treat)) %&gt;%
  ggplot(aes(y=i_cate, x=education)) +
  geom_point(aes(color=treat)) +
  geom_smooth(aes(y=i_cate, x=education)) +
  scale_colour_manual(values=c(&quot;blue&quot;, &quot;orange&quot;)) +
  geom_smooth(color=&#39;black&#39;) +
  scale_x_continuous(breaks = rep(1:8)*2) +
  theme_minimal() 

#combine  plots next to each other
title1=textGrob(&quot;Figure 2: CATE by numeric variables&quot;, gp=gpar(fontface=&quot;bold&quot;))
grid.arrange(p2,  p3, p4, ncol=2, top=title1) </code></pre>
<p><img src="BartLabor_files/figure-html/chk4-1.png" width="672" /></p>
<p>We see that program effectiveness increased with age until a threshold of 30 years. The program seems to have been most effective for people between 5 and 10K USD whereas the relationship between years of education and iCATE is U-shaped. The scatterplots allow to visually distinguish iCATE by treatment status – a very nice feature as discussed above. Next let us assess the interaction of our treatment with the factor variables.</p>
<pre class="r"><code>#Boxplots:
#race
p5 &lt;- data_cate %&gt;%
  ggplot(aes(y=i_cate, x=race)) +
  geom_boxplot()  +
  theme_minimal() 

#married 
p6 &lt;- data_cate %&gt;%
  mutate(married=as.factor(married)) %&gt;%
  ggplot(aes(y=i_cate, x=married)) +
  geom_boxplot() +
  theme_minimal() 

p7 &lt;- data_cate %&gt;%
  mutate(nodegree=as.factor(nodegree)) %&gt;%
  ggplot(aes(y=i_cate, x=nodegree)) +
  geom_boxplot() +
  theme_minimal() 

title2=textGrob(&quot;Figure 2: CATE by factor variables&quot;, gp=gpar(fontface=&quot;bold&quot;))
grid.arrange(p5,  p6, p7, ncol=2, top=title2) </code></pre>
<p><img src="BartLabor_files/figure-html/chk5-1.png" width="672" /></p>
<p>Figure 3 reveals that black colored benefited most from the program whereas being hispanic is associated with negative CATE. Married people benefited highly from program participation as well.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>We analysed the impact of a labor market program by using linear regression and BART, a tree based nonparametric Bayesian regression approach which very successfully recovers the underlying data generating process in the presence of interactions. We have found some evidence for effect moderation of the treatment, especially being married and black color are associated with a positive treatment effect. The relation between pre-treatment income and iCATE is nonlinear. Marital status and income were found to generate interaction effects by <span class="citation">Rolling (2014)</span> as well.</p>
<p>Let us recall the assumption that all relevant control variables are accounted for in the analysis (ignorability). This does not necessary hold true and is also emphasized by the seminal study of <span class="citation">LaLonde (1986)</span>. See for example <span class="citation">VanderWeele &amp; Shpitser (2011)</span> for a discussion of confounder selection. Furthermore, when estimating ATE we mainly focused on modeling the outcome equation of our treatment, hence we implicitly assume no selection into treatment. Luckily, other treatment effects (ATT, ATC) can be generated by re-weighting towards the population of interest <span class="citation">(eg. Morgan &amp; Todd, 2008)</span>, both in case of linear regression and BART.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-angrist2009mostly" class="csl-entry">
Angrist, J. D., &amp; Pischke, J.-S. (2009). <em>Mostly harmless econometrics: An empiricist’s companion</em>. Princeton university press.
</div>
<div id="ref-carnegie2019examining" class="csl-entry">
Carnegie, N., Dorie, V., &amp; Hill, J. L. (2019). Examining treatment effect heterogeneity using BART. <em>Observational Studies</em>, <em>5</em>(2), 52–70.
</div>
<div id="ref-chipman2010bart" class="csl-entry">
Chipman, H. A., George, E. I., &amp; McCulloch, R. E. (2010). BART: Bayesian additive regression trees. <em>The Annals of Applied Statistics</em>, <em>4</em>(1), 266–298.
</div>
<div id="ref-dehejia1999causal" class="csl-entry">
Dehejia, R. H., &amp; Wahba, S. (1999). Causal effects in nonexperimental studies: Reevaluating the evaluation of training programs. <em>Journal of the American Statistical Association</em>, <em>94</em>(448), 1053–1062.
</div>
<div id="ref-hill2011bayesian" class="csl-entry">
Hill, J. L. (2011). Bayesian nonparametric modeling for causal inference. <em>Journal of Computational and Graphical Statistics</em>, <em>20</em>(1), 217–240.
</div>
<div id="ref-hill2020bayesian" class="csl-entry">
Hill, J., Linero, A., &amp; Murray, J. (2020). Bayesian additive regression trees: A review and look forward. <em>Annual Review of Statistics and Its Application</em>, <em>7</em>(1).
</div>
<div id="ref-lalonde1986evaluating" class="csl-entry">
LaLonde, R. J. (1986). Evaluating the econometric evaluations of training programs with experimental data. <em>The American Economic Review</em>, 604–620.
</div>
<div id="ref-morgan20086" class="csl-entry">
Morgan, S. L., &amp; Todd, J. J. (2008). 6. A diagnostic routine for the detection of consequential heterogeneity of causal effects. <em>Sociological Methodology</em>, <em>38</em>(1), 231–282.
</div>
<div id="ref-pearl2013linear" class="csl-entry">
Pearl, J. (2013). Linear models: A useful <span>“microscope”</span> for causal analysis. <em>Journal of Causal Inference</em>, <em>1</em>(1), 155–170.
</div>
<div id="ref-rolling2014estimation" class="csl-entry">
Rolling, C. A. (2014). <em>Estimation of conditional average treatment effects</em> [PhD thesis]. University of Minnesota.
</div>
<div id="ref-rubin2005causal" class="csl-entry">
Rubin, D. B. (2005). Causal inference using potential outcomes: Design, modeling, decisions. <em>Journal of the American Statistical Association</em>, <em>100</em>(469), 322–331.
</div>
<div id="ref-vanderweele2011new" class="csl-entry">
VanderWeele, T. J., &amp; Shpitser, I. (2011). A new criterion for confounder selection. <em>Biometrics</em>, <em>67</em>(4), 1406–1413.
</div>
<div id="ref-haven" class="csl-entry">
Wickham, H., Miller, E., &amp; Smith, D. (2022). <em>Haven: Import and export ’SPSS’, ’stata’ and ’SAS’ files</em>. <a href="https://CRAN.R-project.org/package=haven">https://CRAN.R-project.org/package=haven</a>
</div>
<div id="ref-kableextra" class="csl-entry">
Zhu, H. (2021). <em>kableExtra: Construct complex table with ’kable’ and pipe syntax</em>. <a href="https://CRAN.R-project.org/package=kableExtra">https://CRAN.R-project.org/package=kableExtra</a>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
